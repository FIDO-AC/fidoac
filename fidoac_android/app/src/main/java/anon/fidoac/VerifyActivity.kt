package anon.fidoac

import android.content.Context
import android.os.Bundle
import android.util.Log
import androidx.appcompat.app.AppCompatActivity
import java.util.*
import kotlin.collections.ArrayList

//    <string name="mediator_sign">MEUCIQCWMfKmH8L2Xh2qryKXyIHTWKk2n5HEGQ852zc6Dv8t/QIgBxdNdLOgy6ljD2eIbDW4HC7RHqQmCTsL22ZvcHkREH4=</string>
//    <string name="mediator_cert_3">MIIFHDCCAwSgAwIBAgIJAMNrfES5rhgxMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNVBAUTEGY5MjAwOWU4NTNiNmIwNDUwHhcNMjExMTE3MjMxMDQyWhcNMzYxMTEzMjMxMDQyWjAbMRkwFwYDVQQFExBmOTIwMDllODUzYjZiMDQ1MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAr7bHgiuxpwHsK7Qui8xUFmOr75gvMsd/dTEDDJdSSxtf6An7xyqpRR90PL2abxM1dEqlXnf2tqw1Ne4Xwl5jlRfdnJLmN0pTy/4lj4/7tv0Sk3iiKkypnEUtR6WfMgH0QZfKHM1+di+y9TFRtv6y//0rb+T+W8a9nsNL/ggjnar86461qO0rOs2cXjp3kOG1FEJ5MVmFmBGtnrKpa73XpXyTqRxB/M0n1n/W9nGqC4FSYa04T6N5RIZGBN2z2MT5IKGbFlbC8UrW0DxW7AYImQQcHtGl/m00QLVWutHQoVJYnFPlXTcHYvASLu+RhhsbDmxMgJJ0mcDpvsC4PjvB+TxywElgS70vE0XmLD+OJtvsBslHZvPBKCOdT0MS+tgSOIfga+z1Z1g7+DVagf7quvmag8jfPioyKvxnK/EgsTUVi2ghzq8wm27ud/mIM7AY2qEORR8Go3TVB4HzWQgpZrt3i5MIlCaY504LzSRiigHCzAPlHws+W0rB5N+er5/2pJKnfBSDiCiFAVtCLOZ7gLiMm0jhO2B6tUXHI/+MRPjy02i59lINMRRev56GKtcd9qO/0kUJWdZTdA2XoS82ixPvZtXQpUpuL12ab+9EaDK8Z4RHJYYfCT3Q5vNAXaiWQ+8PTWm2QgBR/bkwSWc+NpUFgNPN9PvQi8WEg5UmAGMCAwEAAaNjMGEwHQYDVR0OBBYEFDZh4QB8iAUJUYtEbEf/GkzJ6k8SMB8GA1UdIwQYMBaAFDZh4QB8iAUJUYtEbEf/GkzJ6k8SMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgIEMA0GCSqGSIb3DQEBCwUAA4ICAQBTNNZe5cuf8oiq+jV0itTGzWVhSTjOBEk2FQvh11J3o3lna0o7rd8RFHnN00q4hi6TapFhh4qaw/iG6Xg+xOan63niLWIC5GOPFgPeYXM9+nBb3zZzC8ABypYuCusWCmt6Tn3+Pjbz3MTVhRGXuT/TQH4KGFY4PhvzAyXwdjTOCXID+aHud4RLcSySr0Fq/L+R8TWalvM1wJJPhyRjqRCJerGtfBagiALzvhnmY7U1qFcS0NCnKjoO7oFedKdWlZz0YAfu3aGCJd4KHT0MsGiLZez9WP81xYSrKMNEsDK+zK5fVzw6jA7cxmpXcARTnmAuGUeI7VVDhDzKeVOctf3a0qQLwC+d0+xrETZ4r2fRGNw2YEs2W8Qj6oDcfPvq9JySe7pJ6wcHnl5EZ0lwc4xH7Y4Dx9RA1JlfooLMw3tOdJZH0enxPXaydfAD3YifeZpFaUzicHeLzVJLt9dvGB0bHQLE4+EqKFgOZv2EoP686DQqbVS1u+9k0p2xbMA105TBIk7npraa8VM0fnrRKi7wlZKwdH+aNAyhbXRW9xsnODJ+g8eF452zvbiKKngEKirK5LGieoXBX7tZ9D1GNBH2Ob3bKOwwIWdEFle/YF/h6zWgdeoaNGDqVBrLr2+0DtWoiB1aDEjLWl9FmyIUyUm7mD/vFDkzF+wm7cyWpQpCVQ==</string>
//    <string name="mediator_cert_0">MIICfTCCAiSgAwIBAgIBATAKBggqhkjOPQQDAjA5MQwwCgYDVQQMDANURUUxKTAnBgNVBAUTIDM5NTI1MmViOTg1YmM1M2MzMGFmZGVjNDY0MDJiMjg2MB4XDTcwMDEwMTAwMDAwMFoXDTQ4MDEwMTAwMDAwMFowHzEdMBsGA1UEAxMUQW5kcm9pZCBLZXlzdG9yZSBLZXkwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASgGWfvXglzZAiz70CdmrTQD5gGCBFS25YT4x6XoDx05MVV9nJx6+HBaIX9/9pUL+WjOOgcyvYkwg33FN7TJ2+Ro4IBNTCCATEwDgYDVR0PAQH/BAQDAgeAMIIBHQYKKwYBBAHWeQIBEQSCAQ0wggEJAgFkCgEBAgFkCgEBBAQBIDAEBAAwTL+FPQgCBgGEWPjnaL+FRTwEOjA4MRIwEAQLYW5vbi5maWRvYWMCAQExIgQga4maGhVRrXbsyCTCCn+ZKzsT5TlzTkEeueyHCRMzQHswgaShCDEGAgECAgEDogMCAQOjBAICAQClBTEDAgEEqgMCAQG/g3cCBQC/hT4DAgEAv4VATDBKBCBC7RvKNS+r1CjzTo/O5id29MssZuBvguWln/RJUme/wgEB/woBAAQgU1BEQHj6XlSaZOBhaK70/jdZyWHZKB+LAsmfnACMTrO/hUEFAgMB1MC/hUIFAgMDFd+/hU4GAgQBNIshv4VPBgIEATSLITAKBggqhkjOPQQDAgNHADBEAiBSGtLdLMvpIkO7eY2xMVDqkAdfGoUiDMGqe/dh9tucUwIgK9SmJ/RJXtoqdw6oZkb0c0rKVL2Vb0CD6ZZjPAFg4JM=</string>
//    <string name="mediator_cert_2">MIIDlDCCAXygAwIBAgIRAI2LIx1pxSkDl7MQEKgdjHAwDQYJKoZIhvcNAQELBQAwGzEZMBcGA1UEBRMQZjkyMDA5ZTg1M2I2YjA0NTAeFw0yMjAxMjUyMzE0MjJaFw0zMjAxMjMyMzE0MjJaMDkxDDAKBgNVBAwMA1RFRTEpMCcGA1UEBRMgMjFjYmY3ZjFkZWM1ZTY3NmZiMTVhOTA5NzJiODdkYzUwdjAQBgcqhkjOPQIBBgUrgQQAIgNiAASBbwcqQL9ujG0ENKY/iadEcJRzpUw4XBsD61WI42Dv41xLIF4lMFVyG5o9OZVooj9/WEUL1lYLbf8xf6dCiUfx031wcrTq9uqKnfOCTDmWaEmUnfb96Pukei/gGToDCYejYzBhMB0GA1UdDgQWBBSNAsnA8KNDbfPyloNHAt6wiPBarjAfBgNVHSMEGDAWgBQ2YeEAfIgFCVGLRGxH/xpMyepPEjAPBgNVHRMBAf8EBTADAQH/MA4GA1UdDwEB/wQEAwICBDANBgkqhkiG9w0BAQsFAAOCAgEAZd08DmopBnFgB4kIB0yRJu6WRessXdVTp/ZPRwQKh4KplIfZ47cQHBmWbHtOKZyr9T3Lvl9waE/pq6ObsrohibzwpT+r8gbBgXIDa/D/B0J0VDQaLEbeqdkehWSwoLfmECO6ze2Y6Z+FLHvq3657Bt+Mm6ZafTEubUR8EW6Zlz1LnOOEswFw974DjSD6AGSnV7OaoI8XRGmAXBg8E1fetZPN6SIIy8gc7DFVkRshfm35t4TPBa7qWfMjrHOFZgroI5xWImgzRZxsKPs+S44zbAyeCf30aP6BSjD70jNWr1lMAbDKqMQKTnx5V1PAVtQc+ACHPOff8qog4eq63/BQmlbko++avjdPjeINd0iAu9gHGaKAmHHMPKMQ8WhXoEyL1PQ8pJ1gQYCzhu/QqaGiVor98LyEhJn60Cs1Miuwzf7tRcz5ANSCGczFDP74mGqid4XpkDU+lDt5gY3Do3EKPQIxXFamBIz0tnu/3R4aJSP3/pLSJwrRMmUkLD6kWxCPP8ZnGhO7B1zwe+I/QTwa9d/FsdWTqhBSok5/Lj9vKPLUWD/eYvRGbp13p5QHAV+aiRaswCc5/7Yei0Smqd+SIx7huLw6NwOZYmZoAKs6tyJg2V0pUtgB9FkXNoz6CLlN7jMIGXrKcDWZOCWfxPdIiLEBJPgZprlMPMGdCF5yXw8=</string>
//    <string name="mediator_cert_1">MIIB8zCCAXqgAwIBAgIRAPi9J3M2c1vC1wdBKUtFptMwCgYIKoZIzj0EAwIwOTEMMAoGA1UEDAwDVEVFMSkwJwYDVQQFEyAyMWNiZjdmMWRlYzVlNjc2ZmIxNWE5MDk3MmI4N2RjNTAeFw0yMjAxMjUyMzE3MzJaFw0zMjAxMjMyMzE3MzJaMDkxDDAKBgNVBAwMA1RFRTEpMCcGA1UEBRMgMzk1MjUyZWI5ODViYzUzYzMwYWZkZWM0NjQwMmIyODYwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQgZsmhOlkTXC5XtUht3P26MgWkh6jifqoc6ZnQGme7+U2jc65hzO8jJN0JHy28N4WADhIn5pVEZHvtQhiyhf3Co2MwYTAdBgNVHQ4EFgQUGcqxiwiuTKOFJveOq4SlcNO5YOkwHwYDVR0jBBgwFoAUjQLJwPCjQ23z8paDRwLesIjwWq4wDwYDVR0TAQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAgQwCgYIKoZIzj0EAwIDZwAwZAIwdmwiMjQcgpS0y7kYeCVUh/4gVDV7WD3529m8aAhM+Eb7kcHqO/p4YDSFh0d25894AjARweGBkDELJ/DQxJ9cd2EYZfX4BNrcwWJ1WGUS65rrHdxI/tlqJ57cxcTP5zag1v0=</string>

//adb shell am start -n anon.fidoac/.VerifyActivity --es id 1 --es ageLimit 20 --es zkproof MiaXboCkdNuTHRN3MGMqBgPzur5d5zf9iA7AHt+VjGd1IDIjpdTuT1jpvKJNxStp1ph9PWhZvyt8UMywiFOd25lotAowK70hMtzcRT/nC1H5Kyfot8avYBOw3PPHJmtPxAHn1O8HkBx6NUM6/5hnBg5DihJ/jAX1x0FxMam4Dka2CfNlzyAwLIWVsdPtPgUlTHFkl81oiQabbXNn1WD3OvyBTq7lhNwKMi18FCvX5T0cjZxqgUPpzYbcZJuvsgYhjlg/eTPvVPKnIDIchhPSNwHlx/DRgjRx5FR9hN87KhS3npTwgeGcXKmrmwoyIoPId+z5qQ8nIHGKdJmMYeK2dq9GwWf2MwZWybv/Gr0KMBj0vjS8KRgTCJ42JfljSbsJIP7eo/rjFC91E419URrjCg== --es clientRandomziedHash ZUe1zUl1oB2KNX6fkNBIuNGe5BCfKy0o9ps36s2hjFc= --es serverChallenge ASAwBA== --es verificationKey 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

class VerifyActivity : AppCompatActivity() {
    val TAG = "FIDO_AC_VerifyActivity"

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        //setContentView(R.layout.activity_verify)

        Log.d(TAG,"Verification: Started")

        val intent = intent
        val file_id = intent.getStringExtra("id")!!.toInt()
        val verificationKey = Base64.getDecoder().decode(intent.getStringExtra("verificationKey")!!)
        Log.d(TAG, verificationKey.size.toString())
        val zkproof = Base64.getDecoder().decode(intent.getStringExtra("zkproof")!!)
        val ageLimit = intent.getStringExtra("ageLimit")!!.toInt()
        val clientRandomziedHash = Base64.getDecoder().decode(intent.getStringExtra("clientRandomziedHash")!!)
        val serverChallenge = Base64.getDecoder().decode(intent.getStringExtra("serverChallenge")!!)
//        val mediatorSignature = Base64.getDecoder().decode(intent.getStringExtra("mediatorSignature")!!)

//        var parsedCert:ArrayList<ByteArray>
//        try {
//            parsedCert
//        }
//        catch (e:Exception){
//
//        }

        val sharedPref = this.getSharedPreferences("result_$file_id", Context.MODE_PRIVATE)
        Log.d(TAG, "Parsed Finished!")
        //        ExampleVerifier.verify(clientRanomziedHash,serverChallenge, mediatorSignature, mediatorCertChains, zkproof, ageLimit, verificationKey)
        if (ExampleVerifier.verifyZKProof(clientRandomziedHash,zkproof,ageLimit,verificationKey)){
            Log.d(TAG, "Verified ZKP!")
            sharedPref.edit().putString("Verified:","yes").commit()
        }
        else{
            Log.e(TAG, "FAILED ZKP!")
            sharedPref.edit().putString("Verified:","no").commit()
        }

        Log.d(TAG,"Verification: Completed")
        finish()
    }
}